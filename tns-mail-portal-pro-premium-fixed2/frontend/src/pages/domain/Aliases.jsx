
import React from 'react'
import { useParams } from 'react-router-dom'
import { useQuery, useQueryClient } from '@tanstack/react-query'
async function fetchAliases(d){ const r=await fetch('/api/aliases?domain='+encodeURIComponent(d)); return r.json() }
export default function Aliases(){ const { domain }=useParams(); const qc=useQueryClient(); const { data }=useQuery({ queryKey:['aliases',domain], queryFn:()=>fetchAliases(domain)}); const items=data?.items||[]; async function createAlias(e){ e.preventDefault(); const fd=new FormData(e.currentTarget); const payload=Object.fromEntries(fd.entries()); const r=await fetch('/api/aliases',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)}); await r.json(); qc.invalidateQueries({ queryKey:['aliases',domain]}); e.currentTarget.reset(); } return (<div className="grid md:grid-cols-2 gap-3"><div className="card"><h3 className="font-semibold mb-2">Aliases</h3><div className="divide-y divide-white/10">{items.map(a=> <div key={a.id} className="py-2">{a.address} â†’ <span className="text-tnsmuted">{a.goto}</span></div>)}{!items.length && <div className="py-2 text-tnsmuted">No aliases.</div>}</div></div><div className="card"><h3 className="font-semibold mb-2">Create Alias</h3><form onSubmit={createAlias} className="grid gap-2"><input name="address" placeholder={"alias@"+domain} className="input" required/><input name="goto" placeholder={"real@"+domain} className="input" required/><button className="btn w-max">Create</button></form></div></div>) }
